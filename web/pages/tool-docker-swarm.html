<!-- 自动拆分自 web/index.html：tool-docker-swarm -->
<section id="page-tool-docker-swarm" class="page">
    <div class="page-header">
        <div class="page-title">
            <h1>Docker Swarm 命令生成器</h1>
            <p class="subtitle">可视化生成 Docker Swarm 和 Stack 命令</p>
        </div>
    </div>
    <div class="docker-swarm-tool">
        <!-- Level 1 Tabs -->
        <div class="tool-tabs-modern" role="tablist" aria-label="Docker Swarm/Stack">
            <button type="button" class="tool-tab tool-tab-modern active" onclick="switchDockerSwarmL1Tab('swarm', event)" role="tab" aria-selected="true">
                <span class="tab-icon" aria-hidden="true"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="2" y1="12" x2="22" y2="12"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/></svg></span>
                <span class="tab-label">Swarm</span>
            </button>
            <button type="button" class="tool-tab tool-tab-modern" onclick="switchDockerSwarmL1Tab('stack', event)" role="tab" aria-selected="false">
                <span class="tab-icon" aria-hidden="true"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/></svg></span>
                <span class="tab-label">Stack</span>
            </button>
        </div>

        <!-- Level 1 Content: Swarm -->
        <div id="docker-swarm-l1-scene-swarm" class="docker-swarm-l1-scene active">
            <!-- Level 2 Tabs: Swarm Operations -->
            <div class="tool-tabs-modern tool-tabs-modern-level2" role="tablist" aria-label="Swarm Operations">
                <button type="button" class="tool-tab tool-tab-modern active" onclick="switchDockerSwarmL2Tab('swarm', 'init', event)" role="tab" aria-selected="true">
                    <span class="tab-icon" aria-hidden="true"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg></span>
                    <span class="tab-label">Init</span>
                </button>
                <button type="button" class="tool-tab tool-tab-modern" onclick="switchDockerSwarmL2Tab('swarm', 'join', event)" role="tab" aria-selected="false">
                    <span class="tab-icon" aria-hidden="true"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/></svg></span>
                    <span class="tab-label">Join</span>
                </button>
                <button type="button" class="tool-tab tool-tab-modern" onclick="switchDockerSwarmL2Tab('swarm', 'leave', event)" role="tab" aria-selected="false">
                    <span class="tab-icon" aria-hidden="true"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg></span>
                    <span class="tab-label">Leave</span>
                </button>
                <button type="button" class="tool-tab tool-tab-modern" onclick="switchDockerSwarmL2Tab('swarm', 'update', event)" role="tab" aria-selected="false">
                    <span class="tab-icon" aria-hidden="true"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="23 4 23 10 17 10"/><polyline points="1 20 1 14 7 14"/><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/></svg></span>
                    <span class="tab-label">Update</span>
                </button>
                <button type="button" class="tool-tab tool-tab-modern" onclick="switchDockerSwarmL2Tab('swarm', 'unlock', event)" role="tab" aria-selected="false">
                    <span class="tab-icon" aria-hidden="true"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 9.9-1"/></svg></span>
                    <span class="tab-label">Unlock</span>
                </button>
            </div>

            <!-- Swarm Init Scene -->
            <div id="docker-swarm-l2-scene-init" class="docker-swarm-l2-scene active">
                <div class="converter-panel">
                    <div class="panel-header"><h3>初始化 Swarm</h3></div>
                    <div class="panel-body">
                        <div class="form-group">
                            <label>广播地址 (--advertise-addr)</label>
                            <input type="text" id="swarm-init-advertise-addr" placeholder="例如: 192.168.1.100" oninput="updateDockerSwarmCommand()">
                        </div>
                        <div class="form-group">
                            <label>监听地址 (--listen-addr)</label>
                            <input type="text" id="swarm-init-listen-addr" placeholder="例如: 0.0.0.0:2377" oninput="updateDockerSwarmCommand()">
                        </div>
                        <div class="form-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="swarm-init-force-new-cluster" onchange="updateDockerSwarmCommand()">
                                强制创建新集群 (--force-new-cluster)
                            </label>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Swarm Join Scene -->
            <div id="docker-swarm-l2-scene-join" class="docker-swarm-l2-scene">
                <div class="converter-panel">
                    <div class="panel-header"><h3>加入 Swarm</h3></div>
                    <div class="panel-body">
                        <div class="form-group">
                            <label>Manager / Worker 地址 *</label>
                            <input type="text" id="swarm-join-addr" placeholder="例如: 192.168.1.100:2377" oninput="updateDockerSwarmCommand()">
                        </div>
                         <div class="form-group">
                            <label>Token *</label>
                            <input type="text" id="swarm-join-token" placeholder="SWMTKN-..." oninput="updateDockerSwarmCommand()">
                        </div>
                        <div class="form-group">
                            <label>广播地址 (--advertise-addr)</label>
                            <input type="text" id="swarm-join-advertise-addr" placeholder="本节点广播地址" oninput="updateDockerSwarmCommand()">
                        </div>
                        <div class="form-group">
                            <label>监听地址 (--listen-addr)</label>
                            <input type="text" id="swarm-join-listen-addr" placeholder="本节点监听地址" oninput="updateDockerSwarmCommand()">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Swarm Leave Scene -->
            <div id="docker-swarm-l2-scene-leave" class="docker-swarm-l2-scene">
                <div class="converter-panel">
                    <div class="panel-header"><h3>离开 Swarm</h3></div>
                    <div class="panel-body">
                        <div class="form-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="swarm-leave-force" onchange="updateDockerSwarmCommand()">
                                强制离开 (--force)
                            </label>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Swarm Update Scene -->
            <div id="docker-swarm-l2-scene-update" class="docker-swarm-l2-scene">
                <div class="converter-panel">
                    <div class="panel-header"><h3>更新 Swarm 设置</h3></div>
                    <div class="panel-body">
                        <div class="form-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="swarm-update-autolock-true" onchange="updateDockerSwarmCommand()">
                                启用自动锁定 (--autolock=true)
                            </label>
                             <label class="checkbox-label">
                                <input type="checkbox" id="swarm-update-autolock-false" onchange="updateDockerSwarmCommand()">
                                禁用自动锁定 (--autolock=false)
                            </label>
                        </div>
                        <div class="form-group">
                            <label>证书有效期 (--cert-expiry)</label>
                            <input type="text" id="swarm-update-cert-expiry" placeholder="例如: 2160h (90天)" oninput="updateDockerSwarmCommand()">
                        </div>
                         <div class="form-group">
                            <label>调度器心跳 (--dispatcher-heartbeat)</label>
                            <input type="text" id="swarm-update-dispatcher-heartbeat" placeholder="例如: 5s" oninput="updateDockerSwarmCommand()">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Swarm Unlock Scene -->
            <div id="docker-swarm-l2-scene-unlock" class="docker-swarm-l2-scene">
                <div class="converter-panel">
                    <div class="panel-header"><h3>解锁 Swarm</h3></div>
                    <div class="panel-body">
                        <p>此操作不需要额外参数。它会提示您输入解锁密钥。</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Level 1 Content: Stack -->
        <div id="docker-swarm-l1-scene-stack" class="docker-swarm-l1-scene">
            <!-- Level 2 Tabs: Stack Operations -->
            <div class="tool-tabs-modern tool-tabs-modern-level2" role="tablist" aria-label="Stack Operations">
                <button type="button" class="tool-tab tool-tab-modern active" onclick="switchDockerSwarmL2Tab('stack', 'deploy', event)" role="tab" aria-selected="true">
                    <span class="tab-icon" aria-hidden="true"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg></span>
                    <span class="tab-label">Deploy</span>
                </button>
                <button type="button" class="tool-tab tool-tab-modern" onclick="switchDockerSwarmL2Tab('stack', 'ls', event)" role="tab" aria-selected="false">
                    <span class="tab-icon" aria-hidden="true"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="8" y1="6" x2="21" y2="6"/><line x1="8" y1="12" x2="21" y2="12"/><line x1="8" y1="18" x2="21" y2="18"/><line x1="3" y1="6" x2="3.01" y2="6"/><line x1="3" y1="12" x2="3.01" y2="12"/><line x1="3" y1="18" x2="3.01" y2="18"/></svg></span>
                    <span class="tab-label">LS</span>
                </button>
                <button type="button" class="tool-tab tool-tab-modern" onclick="switchDockerSwarmL2Tab('stack', 'ps', event)" role="tab" aria-selected="false">
                    <span class="tab-icon" aria-hidden="true"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/><circle cx="12" cy="10" r="3"/></svg></span>
                    <span class="tab-label">PS</span>
                </button>
                 <button type="button" class="tool-tab tool-tab-modern" onclick="switchDockerSwarmL2Tab('stack', 'services', event)" role="tab" aria-selected="false">
                    <span class="tab-icon" aria-hidden="true"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg></span>
                    <span class="tab-label">Services</span>
                </button>
                <button type="button" class="tool-tab tool-tab-modern" onclick="switchDockerSwarmL2Tab('stack', 'rm', event)" role="tab" aria-selected="false">
                    <span class="tab-icon" aria-hidden="true"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/></svg></span>
                    <span class="tab-label">RM</span>
                </button>
            </div>

            <!-- Stack Deploy Scene -->
            <div id="docker-stack-l2-scene-deploy" class="docker-stack-l2-scene active">
                <div class="converter-panel">
                    <div class="panel-header"><h3>部署 Stack</h3></div>
                    <div class="panel-body">
                         <div class="form-group">
                            <label>Stack 名称 *</label>
                            <input type="text" id="stack-deploy-name" placeholder="my-stack" oninput="updateDockerSwarmCommand()">
                        </div>
                        <div class="form-group">
                            <label>Compose 文件 * (多个用逗号分隔)</label>
                            <input type="text" id="stack-deploy-compose-files" placeholder="docker-compose.yml, docker-compose.prod.yml" oninput="updateDockerSwarmCommand()">
                        </div>
                        <div class="form-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="stack-deploy-with-registry-auth" onchange="updateDockerSwarmCommand()">
                                携带注册表认证信息 (--with-registry-auth)
                            </label>
                        </div>
                         <div class="form-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="stack-deploy-prune" onchange="updateDockerSwarmCommand()">
                                清理不再使用的服务 (--prune)
                            </label>
                        </div>
                        <div class="form-group">
                            <label>镜像解析模式 (--resolve-image)</label>
                            <select id="stack-deploy-resolve-image" onchange="updateDockerSwarmCommand()">
                                <option value="always">always</option>
                                <option value="changed">changed</option>
                                <option value="never">never</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Stack LS Scene -->
            <div id="docker-stack-l2-scene-ls" class="docker-stack-l2-scene">
                 <div class="converter-panel">
                    <div class="panel-header"><h3>列出 Stacks</h3></div>
                    <div class="panel-body">
                        <p>此操作不需要额外参数。</p>
                    </div>
                </div>
            </div>

            <!-- Stack PS Scene -->
            <div id="docker-stack-l2-scene-ps" class="docker-stack-l2-scene">
                 <div class="converter-panel">
                    <div class="panel-header"><h3>列出 Stack 中的任务</h3></div>
                    <div class="panel-body">
                         <div class="form-group">
                            <label>Stack 名称 *</label>
                            <input type="text" id="stack-ps-name" placeholder="my-stack" oninput="updateDockerSwarmCommand()">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Stack Services Scene -->
            <div id="docker-stack-l2-scene-services" class="docker-stack-l2-scene">
                 <div class="converter-panel">
                    <div class="panel-header"><h3>列出 Stack 中的服务</h3></div>
                    <div class="panel-body">
                         <div class="form-group">
                            <label>Stack 名称 *</label>
                            <input type="text" id="stack-services-name" placeholder="my-stack" oninput="updateDockerSwarmCommand()">
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Stack RM Scene -->
            <div id="docker-stack-l2-scene-rm" class="docker-stack-l2-scene">
                 <div class="converter-panel">
                    <div class="panel-header"><h3>移除 Stack</h3></div>
                    <div class="panel-body">
                         <div class="form-group">
                            <label>Stack 名称 * (多个用空格分隔)</label>
                            <input type="text" id="stack-rm-names" placeholder="my-stack1 my-stack2" oninput="updateDockerSwarmCommand()">
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 命令预览 -->
        <div class="converter-panel">
            <div class="panel-header">
                <h3>生成的命令</h3>
                <div class="panel-actions">
                    <button class="btn btn-sm btn-ghost" onclick="copyDockerSwarmCommand(this)">复制</button>
                </div>
            </div>
            <div class="panel-body">
                <div class="docker-swarm-command-preview">
                    <div class="docker-swarm-command-desc" id="docker-swarm-command-desc">选择操作类型并填写参数</div>
                    <textarea id="docker-swarm-command-output" readonly placeholder="生成的 Docker Swarm 命令将显示在这里..." spellcheck="false"></textarea>
                </div>
            </div>
        </div>
    </div>
</section>

<style>
/* 保证L1和L2场景切换的显示逻辑 */
.docker-swarm-l1-scene,
.docker-swarm-l2-scene,
.docker-stack-l2-scene {
    display: none;
}
.docker-swarm-l1-scene.active,
.docker-swarm-l2-scene.active,
.docker-stack-l2-scene.active {
    display: block;
}

/* L2 tab的样式，可以比L1小一些 */
.tool-tabs-modern-level2 .tool-tab-modern {
    padding: 6px 12px;
    font-size: 0.9em;
}

.tool-tabs-modern-level2 {
    margin-bottom: 1rem;
}

.docker-swarm-command-preview textarea {
    width: 100%;
    min-height: 80px;
    background-color: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--border-radius-md);
    padding: 0.5rem;
    font-family: var(--font-family-mono);
    color: var(--color-text-primary);
    resize: vertical;
}

.docker-swarm-command-desc {
    margin-bottom: 0.5rem;
    font-size: 0.9em;
    color: var(--color-text-secondary);
}
</style>
